Leveraging Diffusion Models to Enhance
Neural Radiance Fields Representation
[name]
Research Engineer, [compaany]
Introduction
Text2NeRF pipeline as example of Text-to-3D models type
Neural Radiance Fields (NeRF)
Images are synthesized by sampling 5D cooordinates (location
and viewing direction) along camera rays (a), feeding those
locations into an NN to produce a color and volume density (b),
and using volume rendering techniques to composite these
values into an image (c). This rendering function is differentiable,
Architecture: so we can optimize our scene representation by minimizing the
In the first step, a 2D image is generated from a text query and a depth map is estimated, residual between synthesized and ground truth observed images
which are then subjected to slight distortions to initialize an initial NeRF representation. (d).
In the next steps, images from new angles are generated by volume rendering from NeRF
and unknown areas are completed using 2D diffusion. The augmmented image is then Ground truth Bad render from NeRF
distorted to obtain new examples for NeRF retraining.
The final depth map at each step is calculated by comparing the image-to-depth prediction
and the NeRF prediction
(-) Iterative generation mode - completing the drawing of unknown
areas, i.e. may require quite a large number of steps
(-) Quality depends on pre-trained picture models
Text2NeRF: Text-Driven 3D Scene Generation with Neural Radiance Fields arXiV 2023
2
Nerf: Representing scenes as neural radiance fields for view synthesis. Communications of the ACM 2021
The main goal of the task is to show that diffusion models help improve the
quality of the rendered scene using NeRF (Neural radiance field)
To achieve this, the following tasks will be solved:
1) Review of existing methods
2) Selection of suitable methods and their implementaion
3) Integration of selected methods into the NeRF pipeline
4) Comparison of the data obtained before and after integration
Aim and Objectives
3
Methods
Score Distillation Sampling
Input: image and description of the image itself
Generating a single object with a blurred background
Delta Denoising Score
Input: image and description of the image itself
Generating an object with a given background based on a text description and
the object itself
4 Hertz. "Delta denoising score." Proceedinings of the IEEE/CVF International Conference on Computer Vision. 2023.
Delta Denoising Score for NeRF optimization
Unlike the original article, in our case, DDS takes
as input a text description and two images,
ground truth and the image that will be restored.
The resulting gradients will be used to optimize
the performa performance of NeRF.
Ground truth image Text prompt similar to
from DM generating ground
truth image
Image obtained using a
render from NeRF
5
Results before implementaion DDS in NeRF pipeline
Image obtained using a
Ground truth image
render from Nerf during the Ouput from DDS Ouput from SDS
from DM
training
In this case, SDS is not suitable for
solving the problem as it has the
following disadvantages. As a rule, it
allows you to get only one object in the
foreground, a blurred background and
an unrealistic image.
As a result of the experiments, it was
decidde to use 200 iterations to
optimize the image. Image optimization
takes 30 seconds. All measurements
were carried out on a Tesla V100 and
took 7 GB.
6
Results after implementaion DDS in NeRF pipeline (10 epoch)
Image obtained after training NeRF without optimization Ground truth image
Image obtained after training NeRF with DDS optimization
LPIPS: 0.35 LPIPS: 0.33
SSIIM: 0.72 SSIIM: 0.74
PSNR: 23.55 PSNR: 24.19
7
A visual comparison of the differences in 10 epochs
Image obtained after training NeRF with DDS optimization
Image obtained after training NeRF without optimization
There is a clear improvement in the image after DDS optimization. What can be seen on the table leg,
window frame, chairs, carpet and so on
8
Results after implementaion DDS in NeRF pipeline (30 epoch)
Ground truth image Image obtained after training NeRF with DDS optimization
Image obtained after training NeRF without optimization
LPIPS: 0.25 LPIPS: 0.22
SSIIM: 0.80 SSIIM: 0.82
PSNR: 26.36 PSNR: 26.70
9
A visual comparison of the differences in 30 epochs
Image obtained after training NeRF with DDS optimization
Image obtained after training NeRF without optimization
The carpet has become more contrasting and close in color to the ground truth image. Also, the
window frames became clearer after the optimization task
10
Results after implementaion DDS in NeRF pipeline (500 epoch)
Text prompt: Modern office with green carpet, large windows, desks and modern macbook computers, photo realistic, indoor scene, 4k, high resolution
Ground truth image Image obtained after training NeRF with DDS optimization
Image obtained after training NeRF without optimization
LPIPS: 0.105
LPIPS: 0.102
SSIIM: 0.87
SSIIM: 0.88
PSNR: 28.89
PSNR: 29.01
11
A visual comparison of the differences in 500 epochs
Image obtained after training NeRF without optimization Image obtained after training NeRF with DDS optimization
The carpet has become more contrasting and close in color to the ground truth image. Also, the
window frames became clearer after the optimization task
12
A meshes for visual comparison of differences over 500 epochs
Mesh obtained after training NeRF without optimization Mesh obtained after training NeRF with DDS optimization
Mesh is a 3D object representation consisting of a collection of vertices and polygons.
After DDS optimization, the mesh became more complete, especially in the carpet area
13
Conclusions
As a result of the work done, the following results were obtained:
• Algorithms DDS loss was implemented for the Text to 3D model based on Text2NeRF
• Experiments were carried out for DDS loss with different numbers of iterations to understand
when images become redrawn. At the end, experiments were carried out with images of different
quality obtained from the NeRF render.
• Similar experiments were carried out for SDS loss. At the moment, the results obtained from
executing these algorithm are not suitable for NeRF optimization due to the blurry and unfaithful
outpout image.
Text prompt: Modern office with green carpet, large windows, desks and modern macbook computers, photo realistic, indoor scene, 4k, high
resolution
LPIPS SSIIM PSNR
without optimization 0.105 0.87 28.89
DDS 0.102 0.88 29.01
14