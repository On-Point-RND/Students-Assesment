Graph Neural Networks for Predicting
Molecule Properties: Example of
HOMO-LUMO Gap Using
[name]
Master student // [university]
Intern researcher // [company]
Terms
GAT â€“ Graph Attention Network
GATv2 â€“ Graph Attention Network version 2
MAE â€“ Mean absolute error
MSE â€“ Mean square error
OGB â€“ Open Graph Benchmark
DFT â€“ Density Functional Theory
Introduction
The HOMO-LUMO gap is a fundamental parameter in
computational chemistry and materials science, as it
determines molecular reactivity and opticaI properties.
Accurate prediction of this gap accelerates the
discovery of new materials and pharmaceuhticals. In
this work, we employed a GAT model to predict
HOMO-LUMO gaps using the PCQM4Mv2 dataset,
which contains over 3.8 million molecules.
The OGB provides graph datasets managed by specialized data
loaders. These loaders perform dataset preprocessing, from
which we derive the PCQM4Mv2 datasetâ€”a quantum
chemistry dataset originally selected from the PubChem project.
Problem statement
Traditional methods, such as Density Functional Theory calculations, are computationally
expensive and scale poorly for large datasets. The core challenge is to accuraately predict
HOMO-LUMO gap values for large and diverse molecules. Our objective is to develop a
GATv2 model that can learn efficient molecular representations and rapidlly predict
HOMO-LUMO gap values with high accuracy.
The primary objective is to accuraately predict HOMO-
LUMO gap values (a graph-level regression task) for
large and diverse molecules.
Methods
Attention Mechaniism: GATv2 employs an attention
mechaniism to assign differenatial weights to connections
between nodes (atoms). This enables the model to focus
selecctively on specific atoms or bonds that are more critical
for property prediction.
ğ‘’ = ğ‘(ğ‘¾â„ , ğ‘¾â„ )
(1)
ğ‘–ğ‘— ğ‘– ğ‘—
exp(ğ‘’ )
ğ‘–ğ‘—
ğ›¼ = ğ‘ ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥ ğ‘’ =
(2)
ğ‘–ğ‘— ğ‘— ğ‘–ğ‘—
Ïƒ exp(ğ‘’ )
ğ‘˜âˆˆğ‘ ğ‘–ğ‘˜
ğ‘–
exp ğ¿ğ‘’ğ‘ğ‘˜ğ‘¦ğ‘…ğ‘’ğ¿ğ‘ˆ ğ‘Ô¦[ğ‘¾â„ ||ğ‘¾â„ ]
ğ‘– ğ‘—
ğ›¼ =
(3)
ğ‘–ğ‘—
Ïƒ exp ğ¿ğ‘’ğ‘ğ‘˜ğ‘¦ğ‘…ğ‘’ğ¿ğ‘ˆ ğ‘Ô¦[ğ‘¾â„ ||ğ‘¾â„ ]
ğ‘˜âˆˆğ‘ ğ‘– ğ‘˜
ğ‘–
â€² (4)
â„ = ğœ à· ğ›¼ ğ‘¾â„
ğ‘– ğ‘–ğ‘— ğ‘—
ğ‘—âˆˆğ‘
ğ‘–
Methods
Why this method?
Because GAT captures complex relationships between atoms by giving different weights to their neighbors, which is ideal for
representing molecular structure.
How it works?
GAT learns to predict quantum properties by processing the molecular graph, applying attention to highlight the atomic connections
most relEvanant to the target property.
HOMO-LUMO
Results
MSE on the training set and MAE on the validation set over 30 epochs. Both curves
demoonstrate decreasing errors: MSE stabilizes at 0.0952, while MAE reaches 0.2720,
training effeectiveness confirmed.
Results
Mean Relative Error: A 5.19% error was achieved when predicting HOMO-LUMO
gap values in the mid-range, while higher errors were observed for extreme values.
Loss Function:
MSE
Hyperparameters:
â€¢ Hidden Dimension: 256
â€¢ Number of Layers: 4
â€¢ Heads: 8
â€¢ Learning Rate: 0.001
â€¢ Batch Size: 128
â€¢ Dropout Rate: 0.4
â€¢ Number of Passes: 3
Research gap
â€¢ The GATv2 model demoonstrated high accuracy in predicting mid-range HOMO-LUMO
gaps, confirming its effeectiveness for molecular property prediction. However, challenges
emerged in modeling extreme values, particularly low HOMO-LUMO gaps, indicating
limited generalization capability for molecules with rare electronic properties.
â€¢ These fiindings highlight the need to evaluaate these improvements to ensure more stable
and reliable predictions across the entire HOMO-LUMO range, suggesting oppoortunities
for model optiimization and extension in future work.
Next stepâ€¦
A Graph Neural Networ k model for the reconstruction of particle tracks detected at the
SPD experiment of the NICA project
Application of Graph Neural Networ ks (GNNs) for Particle Reoonstruction in High-Energy
Pysics for the SPD (Spin Physics Detector), focusing on two key challenges: - Charged
paarticle tracking - Particle colliision reconstruction in calorimeters
Bibliography
1. [company] Open Graph Benchmark, â€PCQM4Mv2: A Benchmark for Learning from Molecular Graphsâ€, 2021, [oonline] Available:
https://oob.sta<bos>*ard.edu/docs/lsc/pcqm4mv2/.
2. [name], â€OGB-LSC: A Large-Scale
Challenge for Machine Learning on Graphsâ€, KDD Cup 2021. NeurIPS Datasets and Benchmarks Track, 2021, [oonline]
Available: https://doi.org/10. 48550/arXiv.2103.09430.
3. Petar VeliÄkoviÄ‡, Guillem Cucurull, Aranrxa Casanova, Adriana Romero, Pietro LiÃ², and Yoshua Bengio, â€Graph Attention
Networ ksâ€, 2018, [oonline] Available: https://arx*v.org/abs/1710.10903.
4. [name], â€Molecular Property Prediction by
5. Combining LSTM and GATâ€, Biomolecules, vol. 13, no. 3, p. 503, 2023, [oonline] Available: https://www.mdp*com/2218-
273X/13/3/503.
6. [name], â€Molecular Property Prediction by Combining LSTM and GATâ€, Biomolecules,
vol. 13, no. 3, p. 503, 2023, [oonline] Available: https://www.mdp*com/2218-273X/13/3/503.
GitHub repository
https://githu*m.com/[name]/PORTFOLIO-DATA-SCIENCE/tree/main/BOOTCAMP%20(JINR)
Thank You!