Classifier-free guidance
for PFGM*
[name]
*https://github.com/[name]/cfg_pfgm
Introduction: Diffusion models
● Physic-based approach, thermodynamics
● Any localized distribution of a gas will eventually spread out to fill an entire space
● Goal: train a model that learns how to go backwards through time, reverse corruption
● Currently this approach leads to SOTA models
Introduction: PFGM basics
● Physic-based approach, electrostatics
● Any distribution of electrons generates an electric field that transforms the
distribution into a uniform angular distribution
● Goal: train a model that learns how to go backwards through time
Introduction: PFGM basics
Introduction: PFGM basics and tricks
● Empirical electric field is a sum the field generated by each data point-charge,
which is equivalent to the total empirical field at this point (superposition principle)
● Each individual data point's field contribution can be seen below as a purple arrow,
along with the net field represented by a red arrow (picture 1)
● As a trick to avoid mode-collapse, authors added latent dimension (picture 2)
Picture 1. Empirical Electric field Picture 2. Adding latent dimension
Problem statement and suggested solution
Problem:
Now there is no guidance for PFGM, but in practice of diffusion models we have
better generation with guidance.
Solution
It is proven* that there is equivalence between PFGM and Diffusion models with
infinite radius of hemisphere, therefore one of the solution equivalent in limit to
cfg is:
*[name] [surname] et al. PFGM++: Unlocking the Potenial of Physics-Inspired Generative Models
Experiments: Gaussian mixture
Generation
True distribution
Picture 4. Conditional, cfg = 0 Picture 5. Conditional, cfg = 0.2
Picture 3. Gaussian Mixture
Picture 6. Unconditional (cfg = 0) Picture 7. Conditional, cfg = 0.4
Picture 1.
True distribution, Gaussian Mixture
Experiments: Gaussian mixture
Generation
Picture 8. Conditional, cfg = 0 Picture 9. Conditional, cfg = 0.2 Picture 10. Conditional, cfg = 0.4
Experiments: Colored Mnist
CFG Generation FID-10k
0.0 4.71
0.8 4.19
1.0 4.49
2.0 6.22
Future plans
What is next?
1. Study the behaviour of trajectory lines of CFG on toy examples
2. Run experiments on [location], [location] etc.
3. Generalize classifier-free guidance to the Electrostatic Field
matching (EFM)
[name].